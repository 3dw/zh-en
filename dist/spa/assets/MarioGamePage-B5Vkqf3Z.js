import{X as te,r as v,H as ae,V as oe,_ as le,Z as ne,$ as re,a0 as f,a4 as i,a1 as s,aa as ie,a8 as se,ad as C,a5 as h,a2 as j,a3 as E,ar as L,aq as Y,I as q,a7 as J}from"./index-CJpG9EQv.js";import{Q as ue}from"./QPage-6GT5Mf8N.js";import{C as V}from"./ClosePopup-YyIX4C4J.js";const de=[{word:"cat",translation:"貓"},{word:"dog",translation:"狗"},{word:"bird",translation:"鳥"},{word:"fish",translation:"魚"},{word:"tree",translation:"樹"},{word:"flower",translation:"花"},{word:"apple",translation:"蘋果"},{word:"banana",translation:"香蕉"},{word:"orange",translation:"橘子"},{word:"pear",translation:"梨"},{word:"pineapple",translation:"鳳梨"},{word:"mango",translation:"芒果"},{word:"watermelon",translation:"西瓜"},{word:"strawberry",translation:"草莓"},{word:"grape",translation:"葡萄"},{word:"peach",translation:"桃子"},{word:"cherry",translation:"櫻桃"},{word:"father",translation:"爸爸"},{word:"mother",translation:"媽媽"},{word:"brother",translation:"兄弟"},{word:"sister",translation:"姐妹"},{word:"grandfather",translation:"爺爺"},{word:"grandmother",translation:"奶奶"},{word:"uncle",translation:"叔叔"},{word:"aunt",translation:"阿姨"},{word:"cousin",translation:"堂兄弟姊妹"},{word:"baby",translation:"嬰兒"},{word:"bed",translation:"床"},{word:"chair",translation:"椅子"},{word:"table",translation:"桌子"},{word:"sofa",translation:"沙發"},{word:"lamp",translation:"檯燈"},{word:"clock",translation:"時鐘"},{word:"mirror",translation:"鏡子"},{word:"window",translation:"窗戶"},{word:"door",translation:"門"},{word:"book",translation:"書"},{word:"run",translation:"跑步"},{word:"walk",translation:"走路"},{word:"jump",translation:"跳躍"},{word:"swim",translation:"游泳"},{word:"eat",translation:"吃"},{word:"drink",translation:"喝"},{word:"sleep",translation:"睡覺"},{word:"read",translation:"閱讀"},{word:"write",translation:"寫字"},{word:"draw",translation:"畫畫"},{word:"sing",translation:"唱歌"},{word:"dance",translation:"跳舞"},{word:"play",translation:"玩"},{word:"study",translation:"學習"},{word:"cook",translation:"煮飯"},{word:"clean",translation:"打掃"},{word:"wash",translation:"洗"},{word:"brush",translation:"刷"},{word:"smile",translation:"微笑"},{word:"laugh",translation:"大笑"}],ve=te({name:"MarioGamePage",setup(){const a=v(null),t=v(null),y=v(0),w=v(!1),m=v(!1),g=v(!1),r=v(null),u=v({mario:{x:100,y:400,width:32,height:32,type:"mario"},mushrooms:[],platforms:[{x:0,y:450,width:800,height:50,type:"platform"}],currentWord:"",targetWord:""}),p={gravity:.5,jumpForce:-12,moveSpeed:5},o=v({velocityY:0,isJumping:!1,direction:1,isMovingLeft:!1,isMovingRight:!1}),Q=v([{x:100,y:50,width:80,height:40},{x:300,y:70,width:100,height:50},{x:600,y:40,width:90,height:45}]),k=v([{x:100,y:370,width:60,height:80},{x:500,y:370,width:60,height:80},{x:700,y:350,width:60,height:100}]),D=v([{x:200,y:200,width:40,height:40},{x:240,y:200,width:40,height:40},{x:280,y:200,width:40,height:40},{x:400,y:250,width:40,height:40},{x:440,y:250,width:40,height:40}]),x={jump:new Audio("/sounds/correct.mp3"),coin:new Audio("/sounds/correct.mp3"),gameover:new Audio("/sounds/wrong.mp3")},U=()=>{Object.values(x).forEach(e=>{e.load(),e.volume=.5})},F=e=>{e.currentTime=0;const n=e.play();n!==void 0&&n.catch(l=>{console.log("音效播放失敗:",l)})},z=()=>{if(u.value.targetWord){const e=new SpeechSynthesisUtterance(u.value.targetWord);e.lang="en-US",e.rate=.8,e.volume=.8,window.speechSynthesis.speak(e)}},K=()=>{a.value&&(a.value.width=800,a.value.height=500,t.value=a.value.getContext("2d"),t.value&&(t.value.imageSmoothingEnabled=!1))},B=()=>{const e=[],l=[...de].sort(()=>Math.random()-.5).slice(0,3),c=Math.floor(Math.random()*3),d=l[c];if(!d)return;u.value.targetWord=d.word,u.value.currentWord=d.translation;const ee=[{x:180,y:300},{x:400,y:300},{x:620,y:300}];for(let S=0;S<3;S++){const R=ee[S];if(!R)continue;const W=l[S]?.word;W&&e.push({x:R.x,y:R.y,width:32,height:32,type:"mushroom",word:W,isCorrect:S===c})}u.value.mushrooms=e,setTimeout(()=>{z()},500)},I=()=>{t.value&&u.value.mushrooms.forEach(e=>{t.value.fillStyle=e.isCorrect?"#4CAF50":"#FFA000",t.value.fillRect(e.x,e.y,e.width,e.height),t.value.fillStyle="#000";const n=window.innerWidth<=768?"28px":"20px";t.value.font=`bold ${n} Arial`,t.value.textAlign="center";const l=window.innerWidth<=768?-15:-10;t.value.fillText(e.word||"",e.x+e.width/2,e.y+l)})},O=()=>{if(!t.value)return;const e=u.value.mario,n=t.value;n.fillStyle="#ff0000",n.fillRect(e.x,e.y,e.width,e.height),n.fillStyle="#ff0000",n.fillRect(e.x-4,e.y-8,e.width+8,8),n.fillStyle="#ffffff",n.fillRect(e.x-4,e.y-8,e.width+8,4),n.fillStyle="#ffffff";const l=6,c=e.y+8;o.value.direction===1?(n.fillRect(e.x+18,c,l,l),n.fillRect(e.x+8,c,l,l)):(n.fillRect(e.x+8,c,l,l),n.fillRect(e.x+18,c,l,l)),n.fillStyle="#000000";const d=3;o.value.direction===1?(n.fillRect(e.x+20,c+2,d,d),n.fillRect(e.x+10,c+2,d,d)):(n.fillRect(e.x+10,c+2,d,d),n.fillRect(e.x+20,c+2,d,d)),n.fillStyle="#000000",n.fillRect(e.x+6,e.y+20,20,2),n.fillStyle="#0000ff",n.fillRect(e.x,e.y+24,e.width,8)},N=()=>{if(!t.value)return;t.value.fillStyle="#000";const e=window.innerWidth<=768?"32px":"24px";t.value.font=`bold ${e} Arial`,t.value.textAlign="center",t.value.fillText(`找出 "${u.value.currentWord}" 的英文`,400,50)},H=()=>{t.value&&(t.value.clearRect(0,0,800,500),t.value.fillStyle="#87CEEB",t.value.fillRect(0,0,800,500),t.value.fillStyle="#FFFFFF",Q.value.forEach(e=>{t.value.beginPath(),t.value.arc(e.x,e.y,20,0,Math.PI*2),t.value.arc(e.x+15,e.y-10,15,0,Math.PI*2),t.value.arc(e.x+30,e.y,20,0,Math.PI*2),t.value.fill()}),t.value.fillStyle="#8B4513",t.value.fillRect(0,450,800,50),t.value.fillStyle="#B87333",D.value.forEach(e=>{t.value.fillRect(e.x,e.y,e.width,e.height),t.value.strokeStyle="#8B4513",t.value.strokeRect(e.x,e.y,e.width,e.height)}),t.value.fillStyle="#00FF00",k.value.forEach(e=>{t.value.fillRect(e.x,e.y,e.width,e.height),t.value.fillStyle="#00CC00",t.value.fillRect(e.x-5,e.y,5,10),t.value.fillRect(e.x+e.width,e.y,5,10)}),I(),O(),N())},X=()=>{if(!w.value)return;const e=u.value.mario;o.value.isMovingLeft&&(e.x-=p.moveSpeed),o.value.isMovingRight&&(e.x+=p.moveSpeed),e.x=Math.max(0,Math.min(e.x,800-e.width)),o.value.velocityY+=p.gravity,e.y+=o.value.velocityY;const n=l=>{e.y+e.height>l.y&&e.y<l.y+l.height&&e.x+e.width>l.x&&e.x<l.x+l.width&&o.value.velocityY>0&&(e.y=l.y-e.height,o.value.velocityY=0,o.value.isJumping=!1)};u.value.platforms.forEach(n),D.value.forEach(n),k.value.forEach(n),u.value.mushrooms.forEach(l=>{e.y+e.height>l.y&&e.y<l.y+l.height&&e.x+e.width>l.x&&e.x<l.x+l.width&&(l.isCorrect?(y.value+=100,F(x.coin),g.value=!0,w.value=!1):(m.value=!0,F(x.gameover),b()))})},G=()=>{X(),H(),r.value=requestAnimationFrame(G)},T=()=>{w.value||(w.value=!0,y.value=0,B(),r.value=requestAnimationFrame(G),a.value&&a.value.focus())},b=()=>{w.value=!1,r.value&&cancelAnimationFrame(r.value)},$=()=>{b(),u.value.mario.x=100,u.value.mario.y=400,o.value.velocityY=0,o.value.isJumping=!1,y.value=0,m.value=!1,g.value=!1,T()},P=()=>{u.value.mario.x=100,u.value.mario.y=400,o.value.velocityY=0,o.value.isJumping=!1,B(),w.value=!0,a.value&&a.value.focus()},M=e=>{if(!w.value){if(e.code==="Enter"){g.value?(P(),g.value=!1):m.value&&($(),m.value=!1);return}return}switch(e.code){case"Space":e.preventDefault(),o.value.isJumping||(o.value.velocityY=p.jumpForce,o.value.isJumping=!0,F(x.jump));break;case"ArrowLeft":o.value.isMovingLeft=!0,o.value.direction=-1;break;case"ArrowRight":o.value.isMovingRight=!0,o.value.direction=1;break}},A=e=>{switch(e.code){case"ArrowLeft":o.value.isMovingLeft=!1;break;case"ArrowRight":o.value.isMovingRight=!1;break}},Z=e=>{if(w.value)switch(event?.preventDefault(),event?.stopPropagation(),e){case"left":o.value.isMovingLeft=!0,o.value.direction=-1;break;case"right":o.value.isMovingRight=!0,o.value.direction=1;break;case"jump":o.value.isJumping||(o.value.velocityY=p.jumpForce,o.value.isJumping=!0,F(x.jump));break}},_=e=>{switch(event?.preventDefault(),event?.stopPropagation(),e){case"left":o.value.isMovingLeft=!1;break;case"right":o.value.isMovingRight=!1;break}};return ae(()=>{K(),U(),window.addEventListener("keydown",M),window.addEventListener("keyup",A)}),oe(()=>{b(),window.removeEventListener("keydown",M),window.removeEventListener("keyup",A)}),{gameCanvas:a,score:y,isGameRunning:w,showGameOver:m,showCorrectAnswer:g,gameState:u,startGame:T,resetGame:$,continueGame:P,handleKeyDown:M,handleKeyUp:A,handleTouchStart:Z,handleTouchEnd:_}}}),ce={class:"game-header"},fe={class:"game-title"},we={class:"score-display"},he={class:"game-container"},me={class:"game-controls"},ge={class:"control-panel"},ye={class:"virtual-controls"},pe={class:"movement-buttons"},xe={class:"text-h6 text-center q-mb-md"},Se={class:"text-subtitle1 text-center q-mb-sm"},Ce={class:"text-h5 text-center"},Fe={class:"text-h5 text-center q-mb-md"};function Ee(a,t,y,w,m,g){return ne(),re(ue,{class:"mario-game-page"},{default:f(()=>[i("div",ce,[i("h1",fe,[s(ie,{name:"sports_esports",size:"md",color:"primary",class:"q-mr-sm"}),t[16]||(t[16]=se(" Jump Jump English Adventure "))]),i("div",we,"Score: "+C(a.score),1)]),i("div",he,[i("canvas",{ref:"gameCanvas",onKeydown:t[0]||(t[0]=(...r)=>a.handleKeyDown&&a.handleKeyDown(...r)),onKeyup:t[1]||(t[1]=(...r)=>a.handleKeyUp&&a.handleKeyUp(...r)),tabindex:"0"},null,544)]),i("div",me,[i("div",ge,[s(h,{color:"primary",icon:"play_arrow",label:"Start Game",onClick:a.startGame,disable:a.isGameRunning},null,8,["onClick","disable"]),s(h,{color:"secondary",icon:"restart_alt",label:"Reset",onClick:a.resetGame,class:"q-ml-sm"},null,8,["onClick"])]),i("div",ye,[i("div",pe,[s(h,{round:"",color:"primary",icon:"arrow_left",size:"lg",class:"movement-btn",onClick:t[2]||(t[2]=r=>a.handleTouchStart("left")),onMousedown:t[3]||(t[3]=r=>a.handleTouchStart("left")),onMouseup:t[4]||(t[4]=r=>a.handleTouchEnd("left")),onMouseleave:t[5]||(t[5]=r=>a.handleTouchEnd("left"))}),s(h,{round:"",color:"primary",icon:"arrow_right",size:"lg",class:"movement-btn",onClick:t[6]||(t[6]=r=>a.handleTouchStart("right")),onMousedown:t[7]||(t[7]=r=>a.handleTouchStart("right")),onMouseup:t[8]||(t[8]=r=>a.handleTouchEnd("right")),onMouseleave:t[9]||(t[9]=r=>a.handleTouchEnd("right"))})]),s(h,{round:"",color:"secondary",icon:"arrow_upward",size:"lg",class:"jump-btn",onClick:t[10]||(t[10]=r=>a.handleTouchStart("jump")),onMousedown:t[11]||(t[11]=r=>a.handleTouchStart("jump")),onMouseup:t[12]||(t[12]=r=>a.handleTouchEnd("jump")),onMouseleave:t[13]||(t[13]=r=>a.handleTouchEnd("jump"))})]),t[17]||(t[17]=i("div",{class:"instructions"},[i("h3",null,"How to Play:"),i("ul",null,[i("li",null,"使用方向鍵 ← → 移動跳跳人"),i("li",null,"使用空白鍵跳躍"),i("li",null,"頭頂對應的英文單字香菇獲得分數"),i("li",null,"撞到錯誤的香菇會失去生命值")])],-1))]),s(J,{modelValue:a.showGameOver,"onUpdate:modelValue":t[14]||(t[14]=r=>a.showGameOver=r)},{default:f(()=>[s(j,null,{default:f(()=>[s(E,{class:"row items-center"},{default:f(()=>[s(L,{icon:"sentiment_very_dissatisfied",color:"negative","text-color":"white"}),t[18]||(t[18]=i("span",{class:"q-ml-sm"},"Game Over!",-1))]),_:1}),s(E,null,{default:f(()=>[i("div",xe,"正確答案是："+C(a.gameState.targetWord),1),i("div",Se,"中文："+C(a.gameState.currentWord),1),i("div",Ce,"最終得分："+C(a.score),1)]),_:1}),s(Y,{align:"right"},{default:f(()=>[q(s(h,{flat:"",label:"再玩一次",color:"primary",onClick:a.resetGame},null,8,["onClick"]),[[V]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(J,{modelValue:a.showCorrectAnswer,"onUpdate:modelValue":t[15]||(t[15]=r=>a.showCorrectAnswer=r),persistent:""},{default:f(()=>[s(j,{class:"correct-answer-card"},{default:f(()=>[s(E,{class:"row items-center"},{default:f(()=>[s(L,{icon:"celebration",color:"positive","text-color":"white"}),t[19]||(t[19]=i("span",{class:"q-ml-sm text-h6"},"答對了！",-1))]),_:1}),s(E,null,{default:f(()=>[i("div",Fe,"得分："+C(a.score),1),t[20]||(t[20]=i("div",{class:"text-subtitle1 text-center"},"繼續挑戰下一題！",-1))]),_:1}),s(Y,{align:"center"},{default:f(()=>[q(s(h,{flat:"",label:"繼續",color:"primary",onClick:a.continueGame},null,8,["onClick"]),[[V]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Re=le(ve,[["render",Ee],["__scopeId","data-v-ec1ce6d5"],["__file","MarioGamePage.vue"]]);export{Re as default};
