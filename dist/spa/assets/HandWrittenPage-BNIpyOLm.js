import{Q as E}from"./QIcon-B6qT3PvK.js";import{Q as c}from"./QBtn-CSiGfW8i.js";import{Q as R}from"./QAvatar-CW6w41I3.js";import{Q as q,a as D}from"./QCard-wgwxpqxp.js";import{Q as F}from"./QDialog-CX_pDfwA.js";import{Q as X,C as Y}from"./ClosePopup-XXaIWD_e.js";import{Q as $}from"./QPage-D-uqmlqO.js";import{H as N,r as a,o as S,_ as W,J as I,K as j,L as r,N as l,M as n,O as k,Q as p,P as z,p as J}from"./index-CdgplTlC.js";import"./render-BM3yO6JT.js";import"./vm-CQ6RDYX7.js";import"./Ripple-TuFcXgrQ.js";import"./use-dark-9KOc8kee.js";import"./use-timeout-D2LcriVQ.js";import"./focus-manager-zjdVGI5d.js";const U=N({name:"HandWrittenPage",setup(){const t=a(null),e=a(null),i=a(!1),v=a("A"),m=a(!1),y=a(!1),s=a(""),Q=a(!1),h=a(!1),T=a(0),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");let u=0,d=0;S(()=>{M()});const M=()=>{t.value&&(t.value.width=280,t.value.height=280,e.value=t.value.getContext("2d"),e.value&&(e.value.strokeStyle="#000",e.value.lineWidth=8,e.value.lineCap="round",e.value.lineJoin="round"))},P=o=>{i.value=!0,u=o.offsetX,d=o.offsetY},V=o=>{!i.value||!e.value||(e.value.beginPath(),e.value.moveTo(u,d),e.value.lineTo(o.offsetX,o.offsetY),e.value.stroke(),u=o.offsetX,d=o.offsetY)},H=()=>{i.value=!1},L=o=>{if(o.preventDefault(),!t.value)return;const f=t.value.getBoundingClientRect(),w=o.touches[0];if(!w)return;const C=w.clientX-f.left,B=w.clientY-f.top;o.type==="touchstart"?(i.value=!0,u=C,d=B):o.type==="touchmove"&&i.value&&e.value&&(e.value.beginPath(),e.value.moveTo(u,d),e.value.lineTo(C,B),e.value.stroke(),u=C,d=B)},A=()=>{!e.value||!t.value||e.value.clearRect(0,0,t.value.width,t.value.height)},b=()=>{let o;do o=Math.floor(Math.random()*g.length);while(g[o]===v.value);v.value=g[o],A(),m.value=!1};return{canvas:t,currentLetter:v,showResult:m,showHint:y,resultMessage:s,isCorrect:Q,isChecking:h,score:T,startDrawing:P,draw:V,stopDrawing:H,handleTouch:L,clearCanvas:A,checkAnswer:async()=>{if(t.value){h.value=!0;try{await new Promise(f=>setTimeout(f,1e3));const o=!0;Q.value=o,o&&(s.value="太棒了！寫得很好！",T.value+=10),m.value=!0,o&&setTimeout(()=>{b()},1500)}finally{h.value=!1}}},nextLetter:b}}}),K={class:"row items-center q-mb-md"},O={class:"col"},G={class:"text-h6 q-mb-md text-center"},Z={class:"text-primary text-weight-bold text-h4"},x={class:"text-subtitle1 q-mt-sm"},_={class:"text-positive"},ee={class:"row justify-center q-mb-md"},te={class:"col-12 col-sm-6 col-md-4"},se={class:"canvas-container"},oe={class:"row q-gutter-sm justify-center q-mt-md"},le={class:"text-center q-mt-md"},ne={class:"text-h6"},ae=["src"];function re(t,e,i,v,m,y){return I(),j($,{class:"q-pa-md"},{default:r(()=>[l("div",K,[l("h1",O,[n(E,{name:"edit",size:"md",color:"primary",class:"q-mr-sm"}),e[10]||(e[10]=k(" 英文字母手寫練習 "))])]),l("div",G,[l("div",null,[e[11]||(e[11]=k(" 請寫出字母：")),l("span",Z,p(t.currentLetter),1)]),l("div",x,[e[12]||(e[12]=k(" 得分：")),l("span",_,p(t.score),1)])]),l("div",ee,[l("div",te,[l("div",se,[l("canvas",{ref:"canvas",class:"writing-canvas",onMousedown:e[0]||(e[0]=(...s)=>t.startDrawing&&t.startDrawing(...s)),onMousemove:e[1]||(e[1]=(...s)=>t.draw&&t.draw(...s)),onMouseup:e[2]||(e[2]=(...s)=>t.stopDrawing&&t.stopDrawing(...s)),onMouseleave:e[3]||(e[3]=(...s)=>t.stopDrawing&&t.stopDrawing(...s)),onTouchstart:e[4]||(e[4]=(...s)=>t.handleTouch&&t.handleTouch(...s)),onTouchmove:e[5]||(e[5]=(...s)=>t.handleTouch&&t.handleTouch(...s)),onTouchend:e[6]||(e[6]=(...s)=>t.stopDrawing&&t.stopDrawing(...s))},null,544)]),l("div",oe,[n(c,{color:"primary",icon:"check_circle",label:"檢查",onClick:t.checkAnswer,loading:t.isChecking},null,8,["onClick","loading"]),n(c,{color:"secondary",icon:"refresh",label:"清除",onClick:t.clearCanvas},null,8,["onClick"]),n(c,{color:"accent",icon:"skip_next",label:"下一個",onClick:t.nextLetter},null,8,["onClick"])]),l("div",le,[n(c,{flat:"",color:"info",icon:"help",label:"顯示筆順",onClick:e[7]||(e[7]=s=>t.showHint=!0)})])])]),n(F,{modelValue:t.showResult,"onUpdate:modelValue":e[8]||(e[8]=s=>t.showResult=s)},{default:r(()=>[n(q,{style:{"min-width":"300px"}},{default:r(()=>[n(D,{class:"row items-center"},{default:r(()=>[n(R,{icon:t.isCorrect?"sentiment_very_satisfied":"sentiment_dissatisfied",color:t.isCorrect?"positive":"negative","text-color":"white"},null,8,["icon","color"]),l("span",{class:z(["text-h6 q-ml-md",t.isCorrect?"text-positive":"text-negative"])},p(t.resultMessage),3)]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(F,{modelValue:t.showHint,"onUpdate:modelValue":e[9]||(e[9]=s=>t.showHint=s)},{default:r(()=>[n(q,null,{default:r(()=>[n(D,null,{default:r(()=>[l("div",ne,"字母 "+p(t.currentLetter)+" 的筆順",1)]),_:1}),n(D,{class:"q-pt-none"},{default:r(()=>[l("img",{src:`/images/letters/${t.currentLetter.toLowerCase()}.gif`,alt:"筆順動畫"},null,8,ae)]),_:1}),n(X,{align:"right"},{default:r(()=>[J(n(c,{flat:"",label:"關閉",color:"primary"},null,512),[[Y]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ye=W(U,[["render",re],["__scopeId","data-v-dddf768c"],["__file","HandWrittenPage.vue"]]);export{ye as default};
