import{Q as M,a as j,b as S,c as G}from"./QTabPanels-CCPSXyF3.js";import{a3 as X,r as p,O as H,b as R,n as Y,w as Q,a4 as Z,a5 as x,a6 as r,a7 as ee,a8 as f,ac as a,a9 as t,ak as c,A as q,ag as V,aj as b,ad as w,an as $,am as le,al as ne,aq as oe,ah as I,aB as te}from"./index-C2Jvu4SZ.js";import{Q as ae}from"./QPage-DYjURF-c.js";import{u as se}from"./use-quasar-BoCvwCFF.js";import{F as ue}from"./FlashCard-BQU-F8kW.js";import"./touch-CRIVsrmF.js";import"./rtl-DFPa-2ov.js";import"./selection-BvixfCZQ.js";const ie=X({name:"FavoritePage",components:{FlashCard:ue},setup(e,{emit:l}){const g=se(),s=p([]);H(()=>{const n=localStorage.getItem("en_love_arr");console.log(n);function u(i){return i.map(F=>({chinese:F.chinese,english:F.english,flipped:!1}))}n&&(s.value=u(JSON.parse(n)),B()),s.value.length>=4&&(k(),y.value="multipleChoice")});const D=n=>{s.value=s.value.filter(u=>!(u.english===n.english&&u.chinese===n.chinese)),localStorage.setItem("favoriteCards",JSON.stringify(s.value))},y=p("view"),d=p(null),o=p(null),m=p(""),C=p(""),A=p(!1),h=p(0),N=R(()=>d.value?d.value.english.split(" "):[]);function B(){if(s.value.length===0){d.value=null;return}const n=Math.floor(Math.random()*s.value.length);d.value=s.value[n];const u=d.value.english.split(" ");u.length===0?o.value=null:o.value=Math.floor(Math.random()*u.length),m.value="",C.value="",A.value=!1,Y(()=>{const i=document.querySelector("input");i&&i.focus()})}function U(){if(!d.value||o.value===null)return;const n=d.value.english.split(" "),u=o.value!==null&&n[o.value]||"",i=m.value.trim().toLowerCase().replace(/[.,!?;:]/g,""),F=u.trim().toLowerCase().replace(/[.,!?;:]/g,"");i===F?(h.value++,C.value="答對了！您已連續答對"+h.value+"題！",g.notify({type:"positive",message:C.value,position:"top",timeout:2500,actions:[{icon:"close",color:"white"}]}),l("earn-xp",50)):(C.value=`答錯了，正確答案是：${u}`,h.value=0,g.notify({type:"negative",message:C.value,position:"top",timeout:2500,actions:[{icon:"close",color:"white"}]})),A.value=!0;const T=W=>{W.key==="Enter"&&(O(),document.removeEventListener("keydown",T))};document.addEventListener("keydown",T)}function O(){B()}function P(){const n=new SpeechSynthesisUtterance(d.value?.english);window.speechSynthesis.speak(n)}Q(y,n=>{n==="cloze"&&B()});const v=p(null),z=p([]),E=p(null);function k(){if(s.value.length<4){v.value=null;return}const n=Math.floor(Math.random()*s.value.length);v.value=s.value[n],_()}function _(){if(!v.value)return;const n=v.value.english,u=s.value.filter(i=>i.english!==n).map(i=>i.english).sort(()=>Math.random()-.5).slice(0,3);z.value=[{label:n,value:n},...u.map(i=>({label:i,value:i}))].sort(()=>Math.random()-.5)}function L(){E.value===v.value?.english?(h.value++,g.notify({type:"positive",message:`答對了！您已連續答對${h.value}題！獲得100xp！`,position:"top",timeout:2500,actions:[{icon:"close",color:"white"}]}),l("earn-xp",100)):(h.value=0,g.notify({type:"negative",message:`答錯了，正確答案是：${v.value?.english}`,position:"top",timeout:2500,actions:[{icon:"close",color:"white"}]})),k()}function J(){k()}Q(y,n=>{n==="multipleChoice"&&k()});function K(){const n=new SpeechSynthesisUtterance(v.value?.english);window.speechSynthesis.speak(n)}return Q(E,n=>{if(n){const u=new SpeechSynthesisUtterance(n);window.speechSynthesis.speak(u)}}),{favoriteCards:s,removeFromFavorites:D,activeTab:y,currentClozeCard:d,blankIndex:o,userAnswer:m,feedback:C,answered:A,correctCount:h,splitEnglishSentence:N,checkAnswer:U,nextQuestion:O,playAudio:P,currentMultipleChoiceCard:v,multipleChoiceOptions:z,selectedOption:E,checkMultipleChoiceAnswer:L,nextMultipleChoiceQuestion:J,playMultipleChoiceAudio:K}}}),re={class:"q-pa-md full-width"},ce={key:0,class:"text-center q-pa-lg"},de={key:1},pe={key:0,class:"text-center q-pa-lg"},ve={key:1,class:"q-pa-md"},me={key:0},he={key:0,style:{color:"red"}},Ce={class:"q-mt-md"},fe={class:"q-mt-md"},ge={class:"q-mt-md"},ye={key:0,class:"text-center q-pa-lg"},we={key:1,class:"q-pa-md"},ke={key:0},Fe={class:"q-mt-md"},be={class:"q-mt-md"};function Ae(e,l,g,s,D,y){const d=x("FlashCard");return r(),ee(ae,{class:"flex flex-center"},{default:f(()=>[a("div",re,[l[11]||(l[11]=a("h2",null,"我的最愛字卡",-1)),t(j,{modelValue:e.activeTab,"onUpdate:modelValue":l[0]||(l[0]=o=>e.activeTab=o),dense:"","border-color":"primary",class:"q-mb-md"},{default:f(()=>[t(M,{name:"view",label:"檢視卡片"}),t(M,{name:"cloze",label:"克漏字練習"}),t(M,{name:"multipleChoice",label:"四選一測驗"})]),_:1},8,["modelValue"]),t(G,{modelValue:e.activeTab,"onUpdate:modelValue":l[5]||(l[5]=o=>e.activeTab=o),animated:""},{default:f(()=>[t(S,{name:"view"},{default:f(()=>[e.favoriteCards.length===0?(r(),c("div",ce,[t(q,{name:"favorite_border",size:"50px",color:"grey-5"}),l[6]||(l[6]=a("p",{class:"text-grey-7"},"還沒有收藏的字卡",-1)),l[7]||(l[7]=a("p",{class:"text-grey-7"},"在學習時點擊愛心圖示來收藏字卡",-1))])):(r(),c("div",de,[t(d,{sentences:e.favoriteCards,onEarnXp:l[1]||(l[1]=o=>e.$emit("earn-xp",o))},null,8,["sentences"])]))]),_:1}),t(S,{name:"cloze"},{default:f(()=>[e.favoriteCards.length===0?(r(),c("div",pe,[t(q,{name:"favorite_border",size:"50px",color:"grey-5"}),l[8]||(l[8]=a("p",{class:"text-grey-7"},"還沒有收藏的字卡，無法進行克漏字練習",-1))])):(r(),c("div",ve,[e.currentClozeCard?(r(),c("div",me,[a("h2",null,[V(" 中文："+b(e.currentClozeCard.chinese)+" ",1),t(w,{icon:"volume_up",size:"lg",color:"primary",onClick:e.playAudio,flat:""},null,8,["onClick"])]),l[9]||(l[9]=a("h2",null,"英文：",-1)),a("p",null,[(r(!0),c($,null,le(e.splitEnglishSentence,(o,m)=>(r(),c("span",{key:m},[m===e.blankIndex?(r(),c("span",he,"_______")):(r(),c($,{key:1},[V(b(o),1)],64)),V(" "+b(m<e.splitEnglishSentence.length-1?" ":""),1)]))),128))]),a("div",Ce,[t(ne,{autofocus:!0,modelValue:e.userAnswer,"onUpdate:modelValue":l[2]||(l[2]=o=>e.userAnswer=o),label:"請填入缺少的單字",disable:e.answered,onKeydown:l[3]||(l[3]=oe(o=>!e.answered&&e.userAnswer&&e.checkAnswer(),["enter"])),class:"large-input"},null,8,["modelValue","disable"])]),a("div",fe,[t(w,{color:"primary",label:"檢查答案",onClick:e.checkAnswer,disable:e.answered||!e.userAnswer},null,8,["onClick","disable"])]),a("div",ge,[t(w,{color:"secondary",label:"下一題",onClick:e.nextQuestion},null,8,["onClick"])])])):I("",!0)]))]),_:1}),t(S,{name:"multipleChoice"},{default:f(()=>[e.favoriteCards.length<4?(r(),c("div",ye,[t(q,{name:"favorite_border",size:"50px",color:"grey-5"}),l[10]||(l[10]=a("p",{class:"text-grey-7"},"收藏的字卡不足以進行四選一測驗，請收藏更多字卡",-1))])):(r(),c("div",we,[e.currentMultipleChoiceCard?(r(),c("div",ke,[a("h2",null," 中文："+b(e.currentMultipleChoiceCard.chinese),1),t(te,{modelValue:e.selectedOption,"onUpdate:modelValue":l[4]||(l[4]=o=>e.selectedOption=o),options:e.multipleChoiceOptions,type:"radio"},null,8,["modelValue","options"]),a("div",Fe,[t(w,{color:"primary",label:"檢查答案",onClick:e.checkMultipleChoiceAnswer,disable:!e.selectedOption},null,8,["onClick","disable"])]),a("div",be,[t(w,{color:"secondary",label:"下一題",onClick:e.nextMultipleChoiceQuestion},null,8,["onClick"])])])):I("",!0)]))]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const Oe=Z(ie,[["render",Ae],["__scopeId","data-v-34d5448b"],["__file","FavoritePage.vue"]]);export{Oe as default};
