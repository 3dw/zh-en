import{Q as H}from"./QBadge-rr1tcwBj.js";import{aG as se,c as le,aH as oe,b as w,h as p,b4 as ne,j as re,X as ue,r as i,H as ie,V as ce,_ as de,Z as $,$ as ve,a0 as u,a4 as o,a1 as l,a8 as G,ad as k,a5 as x,a3 as A,aq as Q,a2 as T,ab as P,a9 as fe,a7 as me}from"./index-I4eKQSyC.js";import{b as he}from"./format-CJebrXOQ.js";import{Q as ge}from"./QSpinnerDots-C_QvBsnA.js";import{Q as we}from"./QPage-DRbqDKjR.js";const Ce={...se,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},N=50,J=2*N,Z=J*Math.PI,ke=Math.round(Z*1e3)/1e3,j=le({name:"QCircularProgress",props:{...Ce,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:t}){const{proxy:{$q:f}}=re(),y=oe(e),m=w(()=>{const n=(f.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(f.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-n}deg)`:`rotate3d(0, 0, 1, ${n-90}deg)`}}),S=w(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),s=w(()=>J/(1-e.thickness/2)),g=w(()=>`${s.value/2} ${s.value/2} ${s.value} ${s.value}`),d=w(()=>he(e.value,e.min,e.max)),D=w(()=>e.max-e.min),C=w(()=>e.thickness/2*s.value),v=w(()=>{const n=(e.max-d.value)/D.value,c=e.rounded===!0&&d.value<e.max&&n<.25?C.value/2*(1-n/.25):0;return Z*n+c});function b({thickness:n,offset:c,color:B,cls:q,rounded:E}){return p("circle",{class:"q-circular-progress__"+q+(B!==void 0?` text-${B}`:""),style:S.value,fill:"transparent",stroke:"currentColor","stroke-width":n,"stroke-dasharray":ke,"stroke-dashoffset":c,"stroke-linecap":E,cx:s.value,cy:s.value,r:N})}return()=>{const n=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&n.push(p("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:N-C.value/2,cx:s.value,cy:s.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&n.push(b({cls:"track",thickness:C.value,offset:0,color:e.trackColor})),n.push(b({cls:"circle",thickness:C.value,offset:v.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const c=[p("svg",{class:"q-circular-progress__svg",style:m.value,viewBox:g.value,"aria-hidden":"true"},n)];return e.showValue===!0&&c.push(p("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},t.default!==void 0?t.default():[p("div",d.value)])),p("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:y.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:d.value},ne(t.internal,c))}}}),ye=ue({name:"DrawGuessPage",setup(){const e=i(0),t=i(""),f=i(30),y=i(100),m=i(null),S=i(!1),s=i(!1),g=i(0),d=i(""),D=i(!1),C=i(""),v=i(null),b=i(!1),n=i(0),c=i(0),B=["apple","banana","cat","dog","elephant","house","tree","car","bird","fish","flower","sun","moon","star","book","chair","table","phone","computer","keyboard","mouse","door","window","bed","shoe","hat","shirt","pants","sock","clock","watch"],q=localStorage.getItem("drawGuessLevel");q&&(e.value=parseInt(q));function E(){if(!v.value)return;const a=v.value,r=a.getContext("2d");r&&(a.width=a.offsetWidth,a.height=a.offsetHeight,r.strokeStyle="#000",r.lineWidth=3,r.lineCap="round",r.lineJoin="round",r.fillStyle="#fff",r.fillRect(0,0,a.width,a.height))}function V(a){if(b.value=!0,a instanceof MouseEvent)n.value=a.offsetX,c.value=a.offsetY;else if(a instanceof TouchEvent&&a.touches.length>0){const r=a.touches[0],h=v.value?.getBoundingClientRect();h&&r&&(n.value=r.clientX-h.left,c.value=r.clientY-h.top)}}function L(a){if(!b.value||!v.value)return;const r=v.value,h=r.getContext("2d");if(!h)return;let M=0,I=0;if(a instanceof MouseEvent)M=a.offsetX,I=a.offsetY;else if(a instanceof TouchEvent&&a.touches.length>0){const z=a.touches[0],U=r.getBoundingClientRect();z&&(M=z.clientX-U.left,I=z.clientY-U.top)}h.beginPath(),h.moveTo(n.value,c.value),h.lineTo(M,I),h.stroke(),n.value=M,c.value=I}function K(){b.value=!1}function ee(a){a.preventDefault(),V(a)}function te(a){a.preventDefault(),L(a)}function _(){if(!v.value)return;const a=v.value,r=a.getContext("2d");r&&(r.fillStyle="#fff",r.fillRect(0,0,a.width,a.height))}function W(){const a=Math.floor(Math.random()*B.length);t.value=B[a]}function X(){f.value=30,y.value=100,m.value&&clearInterval(m.value),m.value=window.setInterval(()=>{f.value--,y.value=f.value/30*100,f.value<=0&&(F(),Y())},1e3)}function F(){m.value&&(clearInterval(m.value),m.value=null)}function R(){if(t.value){const a=new SpeechSynthesisUtterance(t.value);a.lang="en-US",a.rate=.8,speechSynthesis.speak(a)}}function Y(){F(),setTimeout(()=>{g.value=Math.floor(Math.random()*41)+60,g.value>=90?d.value="太棒了！你的繪圖非常像！":g.value>=80?d.value="很好！你的繪圖很接近！":g.value>=70?d.value="不錯！你的繪圖還算像！":d.value="繼續努力！你的繪圖可以更好！",D.value=!0,C.value=`https://source.unsplash.com/300x300/?${t.value}`,S.value=!0,g.value>=70&&(e.value++,localStorage.setItem("drawGuessLevel",e.value.toString()),e.value>=10&&(s.value=!0))},1e3)}function O(){S.value=!1,D.value=!1,_(),W(),X(),R()}function ae(){e.value=0,localStorage.setItem("drawGuessLevel","0"),s.value=!1,O()}return ie(()=>{E(),W(),X(),R(),window.addEventListener("resize",E)}),ce(()=>{F(),window.removeEventListener("resize",E)}),{level:e,currentWord:t,timeLeft:f,timerProgress:y,userCanvas:v,showResult:S,showGameOver:s,similarityScore:g,resultMessage:d,showAIReference:D,aiReferenceImage:C,startDrawing:V,draw:L,stopDrawing:K,handleTouchStart:ee,handleTouchMove:te,clearCanvas:_,submitDrawing:Y,nextRound:O,resetGame:ae,speakCurrentWord:R}}}),Se={class:"row items-center q-mb-md"},be={class:"col-auto"},pe={class:"text-h6 q-mb-md text-center"},De={class:"text-weight-bold"},Be={class:"text-center q-mb-md"},Ee={class:"row q-col-gutter-md"},xe={class:"col-12 col-md-6"},Ae={class:"col-12 col-md-6"},qe={key:0,class:"ai-placeholder"},Me=["src"],Ie={key:0,class:"result-container q-mt-lg"},$e={class:"text-h4"},Te={class:"text-h6 q-mt-md"},Fe={class:"text-center"},Re={class:"text-h5 q-mb-md"},ze={class:"text-body1"};function Ge(e,t,f,y,m,S){return $(),ve(we,{class:"q-pa-md"},{default:u(()=>[o("div",Se,[t[8]||(t[8]=o("h1",{class:"col"},"繪圖猜字遊戲",-1)),o("div",be,[l(H,{color:"teal",class:"text-h6"},{default:u(()=>[G(" Level: "+k(e.level),1)]),_:1})])]),o("div",pe,[t[9]||(t[9]=G(" 請繪製以下單字: ")),o("span",De,k(e.currentWord),1),l(x,{icon:"volume_up",color:"primary",round:"",size:"lg",class:"q-ml-sm",onClick:e.speakCurrentWord},null,8,["onClick"])]),o("div",Be,[l(j,{value:e.timerProgress,color:"primary",size:"50px",class:"q-mx-auto"},{default:u(()=>[l(H,{color:"primary",class:"text-h6"},{default:u(()=>[G(k(e.timeLeft)+"s",1)]),_:1})]),_:1},8,["value"])]),o("div",Ee,[o("div",xe,[l(T,{class:"drawing-card"},{default:u(()=>[l(A,null,{default:u(()=>[t[10]||(t[10]=o("div",{class:"text-h6 text-center"},"你的繪圖",-1)),o("canvas",{ref:"userCanvas",class:"drawing-canvas",onMousedown:t[0]||(t[0]=(...s)=>e.startDrawing&&e.startDrawing(...s)),onMousemove:t[1]||(t[1]=(...s)=>e.draw&&e.draw(...s)),onMouseup:t[2]||(t[2]=(...s)=>e.stopDrawing&&e.stopDrawing(...s)),onMouseleave:t[3]||(t[3]=(...s)=>e.stopDrawing&&e.stopDrawing(...s)),onTouchstart:t[4]||(t[4]=(...s)=>e.handleTouchStart&&e.handleTouchStart(...s)),onTouchmove:t[5]||(t[5]=(...s)=>e.handleTouchMove&&e.handleTouchMove(...s)),onTouchend:t[6]||(t[6]=(...s)=>e.stopDrawing&&e.stopDrawing(...s))},null,544)]),_:1}),l(Q,{align:"center"},{default:u(()=>[l(x,{color:"primary",label:"清除",onClick:e.clearCanvas},null,8,["onClick"]),l(x,{color:"secondary",label:"提交",onClick:e.submitDrawing},null,8,["onClick"])]),_:1})]),_:1})]),o("div",Ae,[l(T,{class:"drawing-card"},{default:u(()=>[l(A,null,{default:u(()=>[t[12]||(t[12]=o("div",{class:"text-h6 text-center"},"AI 參考圖像",-1)),e.showAIReference?($(),P("img",{key:1,src:e.aiReferenceImage,class:"ai-reference-image",alt:"AI Reference"},null,8,Me)):($(),P("div",qe,[l(ge,{color:"primary",size:"40px"}),t[11]||(t[11]=o("div",{class:"text-center q-mt-md"},"繪製完成後將顯示 AI 參考圖像",-1))]))]),_:1})]),_:1})])]),e.showResult?($(),P("div",Ie,[l(T,null,{default:u(()=>[l(A,{class:"text-center"},{default:u(()=>[t[13]||(t[13]=o("div",{class:"text-h5 q-mb-md"},"相似度評分",-1)),l(j,{value:e.similarityScore,color:"positive",size:"120px",class:"q-mx-auto"},{default:u(()=>[o("div",$e,k(e.similarityScore)+"%",1)]),_:1},8,["value"]),o("div",Te,k(e.resultMessage),1)]),_:1}),l(Q,{align:"center"},{default:u(()=>[l(x,{color:"primary",label:"下一題",onClick:e.nextRound},null,8,["onClick"])]),_:1})]),_:1})])):fe("",!0),l(me,{modelValue:e.showGameOver,"onUpdate:modelValue":t[7]||(t[7]=s=>e.showGameOver=s)},{default:u(()=>[l(T,null,{default:u(()=>[l(A,{class:"row items-center"},{default:u(()=>t[14]||(t[14]=[o("div",{class:"text-h6"},"遊戲結束",-1)])),_:1}),l(A,null,{default:u(()=>[o("div",Fe,[o("div",Re,"你的最終得分: "+k(e.level),1),o("div",ze,"你完成了 "+k(e.level)+" 個單字的繪製!",1)])]),_:1}),l(Q,{align:"center"},{default:u(()=>[l(x,{color:"primary",label:"再玩一次",onClick:e.resetGame},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const _e=de(ye,[["render",Ge],["__scopeId","data-v-e21e75e3"],["__file","DrawGuessPage.vue"]]);export{_e as default};
