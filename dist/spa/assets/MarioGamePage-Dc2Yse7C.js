import{X as ue,r as f,H as ce,V as de,_ as me,Z as ve,$ as fe,a0 as m,a4 as i,a1 as u,aa as Se,a8 as we,ad as x,a5 as y,a2 as G,a3 as p,ar as $,aq as P,I as L,a7 as j}from"./index-DOVxwrvQ.js";import{Q as he}from"./QPage-BKVtMO-Y.js";import{C as U}from"./ClosePopup-DQLpy797.js";const O=[{word:"cat",translation:"貓",minScore:0,maxScore:2e3},{word:"dog",translation:"狗",minScore:0,maxScore:2e3},{word:"bird",translation:"鳥",minScore:0,maxScore:2e3},{word:"fish",translation:"魚",minScore:0,maxScore:2e3},{word:"rabbit",translation:"兔子",minScore:0,maxScore:2e3},{word:"tiger",translation:"老虎",minScore:0,maxScore:2e3},{word:"lion",translation:"獅子",minScore:0,maxScore:2e3},{word:"elephant",translation:"大象",minScore:0,maxScore:2e3},{word:"zebra",translation:"斑馬",minScore:0,maxScore:2e3},{word:"giraffe",translation:"長頸鹿",minScore:0,maxScore:2e3},{word:"panda",translation:"熊貓",minScore:0,maxScore:2e3},{word:"apple",translation:"蘋果",minScore:0,maxScore:2500},{word:"banana",translation:"香蕉",minScore:0,maxScore:2500},{word:"orange",translation:"橘子",minScore:0,maxScore:2500},{word:"pear",translation:"梨",minScore:0,maxScore:2500},{word:"grape",translation:"葡萄",minScore:0,maxScore:2500},{word:"peach",translation:"桃子",minScore:0,maxScore:2500},{word:"cherry",translation:"櫻桃",minScore:0,maxScore:2500},{word:"father",translation:"爸爸",minScore:0,maxScore:3e3},{word:"mother",translation:"媽媽",minScore:0,maxScore:3e3},{word:"baby",translation:"嬰兒",minScore:0,maxScore:3e3},{word:"child",translation:"小孩",minScore:0,maxScore:3e3},{word:"run",translation:"跑步",minScore:0,maxScore:3e3},{word:"walk",translation:"走路",minScore:0,maxScore:3e3},{word:"jump",translation:"跳躍",minScore:0,maxScore:3e3},{word:"eat",translation:"吃",minScore:0,maxScore:3e3},{word:"drink",translation:"喝",minScore:0,maxScore:3e3},{word:"pineapple",translation:"鳳梨",minScore:1e3,maxScore:5e3},{word:"mango",translation:"芒果",minScore:1e3,maxScore:5e3},{word:"watermelon",translation:"西瓜",minScore:1e3,maxScore:5e3},{word:"strawberry",translation:"草莓",minScore:1e3,maxScore:5e3},{word:"brother",translation:"兄弟",minScore:2e3,maxScore:6e3},{word:"sister",translation:"姐妹",minScore:2e3,maxScore:6e3},{word:"grandfather",translation:"爺爺",minScore:2e3,maxScore:6e3},{word:"grandmother",translation:"奶奶",minScore:2e3,maxScore:6e3},{word:"uncle",translation:"叔叔",minScore:2e3,maxScore:6e3},{word:"aunt",translation:"阿姨",minScore:2e3,maxScore:6e3},{word:"cousin",translation:"堂兄弟姊妹",minScore:2e3,maxScore:6e3},{word:"grandchild",translation:"孫子",minScore:2e3,maxScore:6e3},{word:"grandparent",translation:"祖父母",minScore:2e3,maxScore:6e3},{word:"swim",translation:"游泳",minScore:3e3,maxScore:7e3},{word:"sleep",translation:"睡覺",minScore:3e3,maxScore:7e3},{word:"read",translation:"閱讀",minScore:3e3,maxScore:7e3},{word:"write",translation:"寫字",minScore:3e3,maxScore:7e3},{word:"draw",translation:"畫畫",minScore:3e3,maxScore:7e3},{word:"sing",translation:"唱歌",minScore:3e3,maxScore:7e3},{word:"dance",translation:"跳舞",minScore:3e3,maxScore:7e3},{word:"play",translation:"玩",minScore:3e3,maxScore:7e3},{word:"study",translation:"學習",minScore:4e3,maxScore:8e3},{word:"cook",translation:"煮飯",minScore:4e3,maxScore:8e3},{word:"clean",translation:"打掃",minScore:4e3,maxScore:8e3},{word:"wash",translation:"洗",minScore:4e3,maxScore:8e3},{word:"brush",translation:"刷",minScore:4e3,maxScore:8e3},{word:"smile",translation:"微笑",minScore:4e3,maxScore:8e3},{word:"laugh",translation:"大笑",minScore:4e3,maxScore:8e3},{word:"bed",translation:"床",minScore:5e3,maxScore:9e3},{word:"chair",translation:"椅子",minScore:5e3,maxScore:9e3},{word:"table",translation:"桌子",minScore:5e3,maxScore:9e3},{word:"sofa",translation:"沙發",minScore:5e3,maxScore:9e3},{word:"lamp",translation:"檯燈",minScore:5e3,maxScore:9e3},{word:"clock",translation:"時鐘",minScore:5e3,maxScore:9e3},{word:"mirror",translation:"鏡子",minScore:5e3,maxScore:9e3},{word:"window",translation:"窗戶",minScore:5e3,maxScore:9e3},{word:"door",translation:"門",minScore:5e3,maxScore:9e3},{word:"book",translation:"書",minScore:5e3,maxScore:9e3},{word:"tree",translation:"樹",minScore:6e3,maxScore:1e4},{word:"flower",translation:"花",minScore:6e3,maxScore:1e4},{word:"grass",translation:"草",minScore:6e3,maxScore:1e4},{word:"leaf",translation:"葉子",minScore:6e3,maxScore:1e4},{word:"root",translation:"根",minScore:6e3,maxScore:1e4},{word:"stem",translation:"莖",minScore:6e3,maxScore:1e4},{word:"seed",translation:"種子",minScore:6e3,maxScore:1e4},{word:"branch",translation:"枝",minScore:6e3,maxScore:1e4}],ge=ue({name:"MarioGamePage",emits:["earn-xp"],setup(t,{emit:a}){const S=f(null),o=f(null),c=f(0),w=f(!1),s=f(!1),F=f(!1),b=f(null),A=f(!1),d=f({mario:{x:100,y:400,width:32,height:32,type:"mario"},mushrooms:[],platforms:[{x:0,y:450,width:800,height:50,type:"platform"}],currentWord:"",targetWord:""}),C={gravity:.5,jumpForce:-12,moveSpeed:5},r=f({velocityY:0,isJumping:!1,direction:1,isMovingLeft:!1,isMovingRight:!1}),H=f([{x:100,y:50,width:80,height:40},{x:300,y:70,width:100,height:50},{x:600,y:40,width:90,height:45}]),V=f([{x:100,y:370,width:60,height:80},{x:500,y:370,width:60,height:80},{x:700,y:350,width:60,height:100}]),q=f([{x:200,y:200,width:40,height:40},{x:240,y:200,width:40,height:40},{x:280,y:200,width:40,height:40},{x:400,y:250,width:40,height:40},{x:440,y:250,width:40,height:40}]),E={jump:new Audio("/sounds/correct.mp3"),coin:new Audio("/sounds/correct.mp3"),gameover:new Audio("/sounds/wrong.mp3")},N=()=>{Object.values(E).forEach(e=>{e.load(),e.volume=.5})},M=e=>{e.currentTime=0;const n=e.play();n!==void 0&&n.catch(l=>{console.log("音效播放失敗:",l)})},X=()=>{if(d.value.targetWord){const e=new SpeechSynthesisUtterance(d.value.targetWord);e.lang="en-US",e.rate=.8,e.volume=.8,window.speechSynthesis.speak(e)}},Z=()=>{S.value&&(S.value.width=800,S.value.height=500,o.value=S.value.getContext("2d"),o.value&&(o.value.imageSmoothingEnabled=!1))},k=()=>{const e=[],n=O.filter(g=>c.value>=g.minScore&&c.value<=g.maxScore),h=[...n.length>=3?n:O].sort(()=>Math.random()-.5).slice(0,3),K=Math.floor(Math.random()*3),W=h[K];if(!W)return;d.value.targetWord=W.word,d.value.currentWord=W.translation;const se=[{x:180,y:300},{x:400,y:300},{x:620,y:300}];for(let g=0;g<3;g++){const T=se[g];if(!T)continue;const I=h[g]?.word;I&&e.push({x:T.x,y:T.y,width:32,height:32,type:"mushroom",word:I,isCorrect:g===K})}d.value.mushrooms=e,setTimeout(()=>{X()},500)},_=()=>{o.value&&d.value.mushrooms.forEach(e=>{o.value.fillStyle="#FF7700",o.value.fillRect(e.x,e.y,e.width,e.height),o.value.fillStyle="#000";const n=window.innerWidth<=768?"28px":"20px";o.value.font=`bold ${n} Arial`,o.value.textAlign="center";const l=window.innerWidth<=768?-15:-10;o.value.fillText(e.word||"",e.x+e.width/2,e.y+l)})},ee=()=>{if(!o.value)return;const e=d.value.mario,n=o.value;n.fillStyle="#ff0000",n.fillRect(e.x,e.y,e.width,e.height),n.fillStyle="#ff0000",n.fillRect(e.x-4,e.y-8,e.width+8,8),n.fillStyle="#ffffff",n.fillRect(e.x-4,e.y-8,e.width+8,4),n.fillStyle="#ffffff";const l=6,v=e.y+8;r.value.direction===1?(n.fillRect(e.x+18,v,l,l),n.fillRect(e.x+8,v,l,l)):(n.fillRect(e.x+8,v,l,l),n.fillRect(e.x+18,v,l,l)),n.fillStyle="#000000";const h=3;r.value.direction===1?(n.fillRect(e.x+20,v+2,h,h),n.fillRect(e.x+10,v+2,h,h)):(n.fillRect(e.x+10,v+2,h,h),n.fillRect(e.x+20,v+2,h,h)),n.fillStyle="#000000",n.fillRect(e.x+6,e.y+20,20,2),n.fillStyle="#0000ff",n.fillRect(e.x,e.y+24,e.width,8)},ae=()=>{if(!o.value)return;o.value.fillStyle="#000";const e=window.innerWidth<=768?"32px":"24px";o.value.font=`bold ${e} Arial`,o.value.textAlign="center",o.value.fillText(`找出 "${d.value.currentWord}" 的英文`,400,50)},oe=()=>{o.value&&(o.value.clearRect(0,0,800,500),o.value.fillStyle="#87CEEB",o.value.fillRect(0,0,800,500),o.value.fillStyle="#FFFFFF",H.value.forEach(e=>{o.value.beginPath(),o.value.arc(e.x,e.y,20,0,Math.PI*2),o.value.arc(e.x+15,e.y-10,15,0,Math.PI*2),o.value.arc(e.x+30,e.y,20,0,Math.PI*2),o.value.fill()}),o.value.fillStyle="#8B4513",o.value.fillRect(0,450,800,50),o.value.fillStyle="#B87333",q.value.forEach(e=>{o.value.fillRect(e.x,e.y,e.width,e.height),o.value.strokeStyle="#8B4513",o.value.strokeRect(e.x,e.y,e.width,e.height)}),o.value.fillStyle="#00FF00",V.value.forEach(e=>{o.value.fillRect(e.x,e.y,e.width,e.height),o.value.fillStyle="#00CC00",o.value.fillRect(e.x-5,e.y,5,10),o.value.fillRect(e.x+e.width,e.y,5,10)}),_(),ee(),ae())},te=()=>{if(!w.value)return;const e=d.value.mario;r.value.isMovingLeft&&(e.x-=C.moveSpeed),r.value.isMovingRight&&(e.x+=C.moveSpeed),e.x=Math.max(0,Math.min(e.x,800-e.width)),r.value.velocityY+=C.gravity,e.y+=r.value.velocityY;const n=l=>{e.y+e.height>l.y&&e.y<l.y+l.height&&e.x+e.width>l.x&&e.x<l.x+l.width&&r.value.velocityY>0&&(e.y=l.y-e.height,r.value.velocityY=0,r.value.isJumping=!1)};d.value.platforms.forEach(n),q.value.forEach(n),V.value.forEach(n),d.value.mushrooms.forEach(l=>{if(e.y+e.height>l.y&&e.y<l.y+l.height&&e.x+e.width>l.x&&e.x<l.x+l.width){const v=new SpeechSynthesisUtterance(l.word||"");v.lang="en-US",v.rate=.8,v.volume=.8,window.speechSynthesis.speak(v),l.isCorrect?(c.value+=100,a("earn-xp",50),M(E.coin),F.value=!0,w.value=!1):(c.value=Math.max(0,c.value-1e3),A.value=!0,w.value=!1,c.value<=0&&(s.value=!0,R()))}})},Y=()=>{te(),oe(),b.value=requestAnimationFrame(Y)},J=()=>{w.value||(w.value=!0,c.value=0,k(),b.value=requestAnimationFrame(Y),S.value&&S.value.focus())},R=()=>{w.value=!1,b.value&&cancelAnimationFrame(b.value)},z=()=>{R(),d.value.mario.x=100,d.value.mario.y=400,r.value.velocityY=0,r.value.isJumping=!1,c.value=0,s.value=!1,F.value=!1,A.value=!1,J()},re=()=>c.value<1e3?"Beginner":c.value<2e3?"Easy":c.value<3e3?"Medium":c.value<4e3?"Hard":c.value<5e3?"Expert":c.value<6e3?"Master":c.value<7e3?"Grand Master":c.value<8e3?"Legend":c.value<9e3?"Mythic":"Divine",Q=()=>{d.value.mario.x=100,d.value.mario.y=400,r.value.velocityY=0,r.value.isJumping=!1,k(),w.value=!0,S.value&&S.value.focus()},ne=()=>{d.value.mario.x=100,d.value.mario.y=400,r.value.velocityY=0,r.value.isJumping=!1,k(),w.value=!0,S.value&&S.value.focus()},D=e=>{if(!w.value){if(e.code==="Enter"){F.value?(Q(),F.value=!1):s.value&&(z(),s.value=!1);return}return}switch(e.code){case"Space":e.preventDefault(),r.value.isJumping||(r.value.velocityY=C.jumpForce,r.value.isJumping=!0,M(E.jump));break;case"ArrowLeft":r.value.isMovingLeft=!0,r.value.direction=-1;break;case"ArrowRight":r.value.isMovingRight=!0,r.value.direction=1;break}},B=e=>{switch(e.code){case"ArrowLeft":r.value.isMovingLeft=!1;break;case"ArrowRight":r.value.isMovingRight=!1;break}},le=e=>{if(w.value)switch(event?.preventDefault(),event?.stopPropagation(),e){case"left":r.value.isMovingLeft=!0,r.value.direction=-1;break;case"right":r.value.isMovingRight=!0,r.value.direction=1;break;case"jump":r.value.isJumping||(r.value.velocityY=C.jumpForce,r.value.isJumping=!0,M(E.jump));break}},ie=e=>{switch(event?.preventDefault(),event?.stopPropagation(),e){case"left":r.value.isMovingLeft=!1;break;case"right":r.value.isMovingRight=!1;break}};return ce(()=>{Z(),N(),window.addEventListener("keydown",D),window.addEventListener("keyup",B)}),de(()=>{R(),window.removeEventListener("keydown",D),window.removeEventListener("keyup",B)}),{gameCanvas:S,score:c,isGameRunning:w,showGameOver:s,showCorrectAnswer:F,showWrongAnswer:A,gameState:d,startGame:J,resetGame:z,continueGame:Q,continueAfterWrong:ne,getDifficultyLevel:re,handleKeyDown:D,handleKeyUp:B,handleTouchStart:le,handleTouchEnd:ie,emit:a}}}),xe={class:"game-header"},ye={class:"game-title"},pe={class:"score-display"},Fe={class:"difficulty-level"},Ce={class:"game-container"},be={class:"game-controls"},Ee={class:"control-panel"},Ae={class:"virtual-controls"},Me={class:"movement-buttons"},ke={class:"text-h6 text-center q-mb-md"},Re={class:"text-subtitle1 text-center q-mb-sm"},De={class:"text-h5 text-center"},Be={class:"text-h5 text-center q-mb-md"},We={class:"text-subtitle1 text-center"},Te={class:"text-subtitle1 text-center"};function Ge(t,a,S,o,c,w){return ve(),fe(he,{class:"mario-game-page"},{default:m(()=>[i("div",xe,[i("h1",ye,[u(Se,{name:"sports_esports",size:"md",color:"primary",class:"q-mr-sm"}),a[17]||(a[17]=we(" Jump Jump English Adventure "))]),i("div",pe,[i("div",null,"Score: "+x(t.score),1),i("div",Fe,"Level: "+x(t.getDifficultyLevel()),1),a[18]||(a[18]=i("div",{class:"xp-info"},"答對可獲得 50 XP",-1))])]),i("div",Ce,[i("canvas",{ref:"gameCanvas",onKeydown:a[0]||(a[0]=(...s)=>t.handleKeyDown&&t.handleKeyDown(...s)),onKeyup:a[1]||(a[1]=(...s)=>t.handleKeyUp&&t.handleKeyUp(...s)),tabindex:"0"},null,544)]),i("div",be,[i("div",Ee,[u(y,{color:"primary",icon:"play_arrow",label:"Start Game",onClick:t.startGame,disable:t.isGameRunning},null,8,["onClick","disable"]),u(y,{color:"secondary",icon:"restart_alt",label:"Reset",onClick:t.resetGame,class:"q-ml-sm"},null,8,["onClick"])]),i("div",Ae,[i("div",Me,[u(y,{round:"",color:"primary",icon:"arrow_left",size:"lg",class:"movement-btn",onClick:a[2]||(a[2]=s=>t.handleTouchStart("left")),onMousedown:a[3]||(a[3]=s=>t.handleTouchStart("left")),onMouseup:a[4]||(a[4]=s=>t.handleTouchEnd("left")),onMouseleave:a[5]||(a[5]=s=>t.handleTouchEnd("left"))}),u(y,{round:"",color:"primary",icon:"arrow_right",size:"lg",class:"movement-btn",onClick:a[6]||(a[6]=s=>t.handleTouchStart("right")),onMousedown:a[7]||(a[7]=s=>t.handleTouchStart("right")),onMouseup:a[8]||(a[8]=s=>t.handleTouchEnd("right")),onMouseleave:a[9]||(a[9]=s=>t.handleTouchEnd("right"))})]),u(y,{round:"",color:"secondary",icon:"arrow_upward",size:"lg",class:"jump-btn",onClick:a[10]||(a[10]=s=>t.handleTouchStart("jump")),onMousedown:a[11]||(a[11]=s=>t.handleTouchStart("jump")),onMouseup:a[12]||(a[12]=s=>t.handleTouchEnd("jump")),onMouseleave:a[13]||(a[13]=s=>t.handleTouchEnd("jump"))})]),a[19]||(a[19]=i("div",{class:"instructions"},[i("h3",null,"How to Play:"),i("ul",null,[i("li",null,"使用方向鍵 ← → 移動跳跳人"),i("li",null,"使用空白鍵跳躍"),i("li",null,"頭頂對應的英文單字香菇獲得分數"),i("li",null,"撞到錯誤的香菇會失去生命值")])],-1))]),u(j,{modelValue:t.showGameOver,"onUpdate:modelValue":a[14]||(a[14]=s=>t.showGameOver=s)},{default:m(()=>[u(G,null,{default:m(()=>[u(p,{class:"row items-center"},{default:m(()=>[u($,{icon:"sentiment_very_dissatisfied",color:"negative","text-color":"white"}),a[20]||(a[20]=i("span",{class:"q-ml-sm"},"Game Over!",-1))]),_:1}),u(p,null,{default:m(()=>[i("div",ke,"正確答案是："+x(t.gameState.targetWord),1),i("div",Re,"中文："+x(t.gameState.currentWord),1),i("div",De,"最終得分："+x(t.score),1)]),_:1}),u(P,{align:"right"},{default:m(()=>[L(u(y,{flat:"",label:"再玩一次",color:"primary",onClick:t.resetGame},null,8,["onClick"]),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(j,{modelValue:t.showCorrectAnswer,"onUpdate:modelValue":a[15]||(a[15]=s=>t.showCorrectAnswer=s),persistent:""},{default:m(()=>[u(G,{class:"correct-answer-card"},{default:m(()=>[u(p,{class:"row items-center"},{default:m(()=>[u($,{icon:"celebration",color:"positive","text-color":"white"}),a[21]||(a[21]=i("span",{class:"q-ml-sm text-h6"},"答對了！",-1))]),_:1}),u(p,null,{default:m(()=>[i("div",Be,"得分："+x(t.score),1),a[22]||(a[22]=i("div",{class:"text-subtitle1 text-center"},"繼續挑戰下一題！",-1))]),_:1}),u(P,{align:"center"},{default:m(()=>[L(u(y,{flat:"",label:"繼續",color:"primary",onClick:t.continueGame},null,8,["onClick"]),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(j,{modelValue:t.showWrongAnswer,"onUpdate:modelValue":a[16]||(a[16]=s=>t.showWrongAnswer=s),persistent:""},{default:m(()=>[u(G,{class:"wrong-answer-card"},{default:m(()=>[u(p,{class:"row items-center"},{default:m(()=>[u($,{icon:"sentiment_dissatisfied",color:"negative","text-color":"white"}),a[23]||(a[23]=i("span",{class:"q-ml-sm text-h6"},"答錯了！",-1))]),_:1}),u(p,null,{default:m(()=>[a[24]||(a[24]=i("div",{class:"text-h5 text-center q-mb-md"},"扣分：-1000",-1)),i("div",We,"當前分數："+x(t.score),1),i("div",Te,"正確答案是："+x(t.gameState.targetWord),1)]),_:1}),u(P,{align:"center"},{default:m(()=>[L(u(y,{flat:"",label:"繼續",color:"primary",onClick:t.continueAfterWrong},null,8,["onClick"]),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const je=me(ge,[["render",Ge],["__scopeId","data-v-4350f89a"],["__file","MarioGamePage.vue"]]);export{je as default};
